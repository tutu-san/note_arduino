# Arduinoの基本の書き方を学ぶ (section 1)

## section 1.1 Arduino のはじめの画面
目的 ： Arduino独特の setup関数、loop関数について学ぶとともに、 <Arduino.h>のインクルードの必要について周知する
```cpp
#include <Arduino.h> //platformIO only

void setup(){

}

void loop(){

}
```
Arduino IDE や VSCode (以下両方含めて "IDE" とします)を開いて、Arduinoのプロジェクトを新規作成すると、このような表示になる。  

すでに二つの関数```setup()```と```loop()```がありますね。
この関数がArduinoの開発にとって、とっても重要なものになります。  
まずは左の```setup()```について、この関数はArduinoが起動or書きこみご一度だけ実行される関数です。主に１度だけ実行されればよいセットアップ関係に関係するコードを書きます。  
次にもう一つの```loop()```について、この関数は先ほどの```setup()```が実行された後、ずっと繰り返し実行される関数です。
この二つの関数に他の関数を書いていくことになります。

```#include <Arduino.h>```が一番上にある人もいると思います。書かれてなかったら、これは書きましょう。  
Arduino IDE以外では、 Arduino用のファイルをインクルードする必要があるからです。

<details> <summary>おまけ：実際にsetupとloopを使用した例</summary><div>
  
```cpp
//簡単な Lチカのコード
void setup(){
  pinMode(11, OUTPUT); //ピンの初期設定
}
  
void loop(){
  digitalWrite(11, HIGH); //11番ピンから電流を流す
  delay(100);             //100ms待つ
  digitalWrite(11, LOW);  //11番ピンからの電流を止める
  delay(100);             //100ms待つ
}
```

```cpp
//校内ロボコンで使用したコード(改)
void setup(){
	//UART(シリアル)通信関係
	Serial.begin(115200); //PCで状況を見るためにポートを開けている

	//ステッピング関係の初期設定
	l6470_setup();

	//LED1
	pinMode(LED1_PIN, OUTPUT);

	//電磁弁のピンの初期設定  (これくらいなら関数化するまでもない)
	pinMode(VALVE_SIGN1, OUTPUT);
    	digitalWrite(VALVE_SIGN1, LOW);

    //コントローラーの初期設定
    ps4_init();
}

void loop(){
    //コントローラーの受信関連の関数(ループで実行する)
	ps4_receive();
}
```
```setup()```に初期設定を、```loop()```にその後の処理をさせていることがわかるでしょうか？
<br>
ところで、校内ロボコンの例では、```setup()```や```loop()```にたくさんの処理を直接書くようなことをしていません。
<br>
機能別に関数を作り、分けたほうが、読みやすく、修正しやすくなることが多いからです。
</div> 
</details>

## section 1.2 Lチカをもう一度やってみよう
目的 ： Lチカをすることで、Arduinoのデジタル出力の方法について学ぶ
### 用意するもの
* Arduino nano 
* ブレッドボード
* 抵抗(1kΩ)
* ジャンパ線
* LED

### 回路を組む
#### 復習 ： ブレッドボード
体験の時の復習になるが、ブレッドボードは短い辺の方が、電気的につながっています(図中の黒線方向)。  
<img src="https://user-images.githubusercontent.com/106954082/228745989-886c0635-d565-4d32-9e69-351bf8846512.png" width="40%">  
つまり、つなぎ方は部品同士のつなぎ方は次図のようになります。  
<img src="https://github.com/tutu-san/note_arduino/assets/106954082/2176bd40-e6f8-4354-ac46-2bc859106e36" width="40%">  
↑自分でも擁護できない程ひどい図(修正したいね)  

この図から電気の流れが読み取れるでしょうか？(ひどくて読めないかも...)  
この図の回路は電気的にしっかりとつながっています。確認してみましょう。  

#### Arduinoをブレッドボードつないで回路を作る
では、復習をしたところで、回路を作っていきましょう。    
<img src="https://github.com/tutu-san/note_arduino/assets/106954082/d69811c3-94a9-4b9d-983e-d2d07721c127" width="70%">  
この回路図を参考にして、回路を作ってみましょう。(見にくかったらごめん)  
Arduino nano のピンは + 側を D5 ピンに、 - 側を GND ピンにつないでください。  

今回の回路のチェックポイント(電源を入れる前に確かめること)
*  ＋ 側がD5ピン 、ー 側が GNDピン につながっていることを確かめる
* LEDのアノード(+)、カソード(-)の向きは良いか確かめる

### プログラムを書く
回路ができたら、プログラムを書いてみましょう。  
#### 新しいもの
今回初めて出る関数は、3つです。一つひとつ紹介します。  

1. pinMode (関数)
```cpp
pinMode(uint8_t pin, uint8_t mode);
```
```pinMode```関数では、 Arduinoのピンの入力/出力の設定の切り替えができます。  
```pin```には、ピン番号を入力します(uint8_tなので整数だよ)。  
```mode```には、入力/出力、どっちにするかを設定します。```INPUT```が入力、```OUTPUT```が出力です(他にも、オプションがあります。)。  

2. digitalWrite (関数)
```cpp
digitalWrite(uint8_t pin, uint8_t val);
```
デジタルピンに```HIGH```もしくは、```LOW```の値を出力する関数です。  
もう少しかみ砕いて言うと、電源のON/OFFを切り替える感じです。  
```pin```には、ピン番号を入力します(uint8_tなので整数だよ)。  
```mode```には、```HIGH```(電源ON)か、```LOW```(電源OFF)を入れます。  
(実は、HIGH/LOWは、 #define で 1/0 という風に定義されているだけなので、 0とか、1とか入れると動く)  

3. delay (関数)
```cpp
delay(unsigned long ms)
```
プログラムの実行を一時停止することができる関数です。実行されると、すべての処理が一旦止まります。  
今回は、LEDの点滅間隔を伸ばすために使います。  
引数が```ms```となっていることからわかるように、単位はミリ秒(ms)です。  
(```unsigned lomg```型となっていますが、整数型だと思ってください。)  
